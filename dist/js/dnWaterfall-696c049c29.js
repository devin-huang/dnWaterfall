"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _toConsumableArray(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?t(require("jquery")):t(jQuery)}(function(r){var n="dnWaterfall",t="1.0.0";r[n]&&r[n].version>t||(r[n]=function(t,n){var e=this;return this.container=t,this.options=n,this.winWd=r(window).width(),this.winHg=r(window).height(),this.scrolltop=0,this.defalutCol=0,this.api=["init","destroy"],this.init(),r(window).on("resize",function(t){e.getBeforeContent(),e.defalutCol!==e.attrVal[0]&&(e.init(),e.defalutCol=e.attrVal[0])}),r(window).on("scroll",function(){e.scrolltop=r(this).scrollTop(),e.showIMG()}),r(this.container.find(".waterfall-area")).on("click",function(){var t=r(this).find("img.waterfall-pic").attr("src");e.slide(t)}),this},r[n].version=t,r[n].defaults={name:"Devin",isClass:!1,doFn:null},r[n].prototype={init:function(){this.getBeforeContent(),this.createDom(),this.getImgItems(),this.setImgArrs(),this.deleteDefaultImgDOM()},getBeforeContent:function(){this.content=window.getComputedStyle(this.container.get(0),"::before").getPropertyValue("content"),this.attrVal=this.content.replace(/\"/g,"").split("+")},getImgItems:function(){var t=this.container.find("img.waterfall-img").map(function(t,n){return n.getAttribute("lazy-src")});return this.filterImgItem(t)},deleteDefaultImgDOM:function(){this.container.children("img.waterfall-img").hide()},filterImgItem:function(t){var e=[].concat(_toConsumableArray(Array(parseInt(this.attrVal[0])).keys()));return e.map(function(n){return t.filter(function(t){return t%e.length==n})})},setImgArrs:function(){var o=this,s=0,l=this.container.find("img.waterfall-img").length-1,c=this.getImgItems();r.each(c,function(a,t){r.each(t,function(t,n){var e=o.container.hasClass("done")?c[a][t]:"",i=o.container.hasClass("done")?"done":"hidden",r='<div class="waterfall-area">\n                                <a class="waterfall-link" href="javascript:void(0)">\n                                  <img lazy-src="'+c[a][t]+'" class="waterfall-pic '+i+'" src="'+e+'"></img>\n                                </a>\n                              </div>';o.column.eq(a).append(r),l<=s&&o.showIMG(),s++})})},showIMG:function(){var i=this;this.container.addClass("done").find(".waterfall-pic").each(function(t,n){var e=r(n);setTimeout(function(){var t=e.offset().top;i.winHg+i.scrolltop>t&&e.addClass("done").attr("src",e.attr("lazy-src")).fadeIn().parent(".waterfall-link").addClass("loaded"),setTimeout(function(){e.hasClass("done")&&e.removeClass("hidden").parents(".waterfall-area").addClass("done")},500)},5*t)})},createDom:function(){var t='<div class="column '+this.attrVal[1]+'"></div>';this.deleteDom();for(var n=0;n<this.attrVal[0];n++)this.container.prepend(t);this.column=this.container.find(".column")},deleteDom:function(){this.column=this.container.find(".column"),this.column.remove()},slide:function(t){var n=r('<div class="dnWaterfall-mask" />'),e=r('<div class="dnWaterfall-box" />');this.column.parents("body").prepend(n).find(n).prepend(e);var i=new Image;r(i).on("load error",function(){var t=i.width,n=i.height;e.prepend(i).css({marginLeft:-t/2,marginTop:-n/2})}),i.src=t,n.on("click",function(t){"IMG"!==t.target.tagName&&r(n).remove()})},destroy:function(){},defaultDOM:function(t){},_api_:function(){var e=this,i={};return r.each(this.api,function(t){var n=this;i[n]=function(){var t=e[n].apply(e,arguments);return void 0===t?i:t}}),i}},r.fn[n]=function(t){return t=r.extend(!0,{},r[n].defaults,t),this.each(function(){r(this).data(n,new r[n](r(this),t)._api_())})})});